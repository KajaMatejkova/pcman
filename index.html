<html>

<head>
  <meta charset="UTF-8" />
  <title>Pacman</title>
</head>

<body>
  <div id="stage">
    <div id="pacman"></div>
  </div>
</body>

<script>
  const TILE_SIZE = 85;
  
  document.body.style.margin = '0';

  const pacmanElm = document.querySelector('#pacman');
  pacmanElm.style.width = TILE_SIZE;
  pacmanElm.style.height = TILE_SIZE;
  pacmanElm.style.backgroundImage = 'url(img/pacgirl-active-light.png)';
  pacmanElm.style.position = 'absolute';
  
  const stageElm = document.querySelector('#stage');
  stageElm.style.width = 10 * TILE_SIZE;
  stageElm.style.height = 10 * TILE_SIZE;
  stageElm.style.backgroundImage = 'url(img/tile.png)';

  let pacX = 0;
  let pacY = 0;
  let mouthOpen = true

  const updatePacman = (x, y) => {
    const pacmanElm = document.querySelector('#pacman');
    pacmanElm.style.left = x;
    pacmanElm.style.top = y;
    if (mouthOpen){
      pacmanElm.style.backgroundPositionX  = String(TILE_SIZE)+ "px";
      mouthOpen =false
    }
    else{
      pacmanElm.style.backgroundPositionX  = 0;
      mouthOpen =true
    }
  };

  const handleKeyDown = (event) => {
    if(event.keyCode === 39) {
      pacX += TILE_SIZE;
      if (pacX >= 9 * TILE_SIZE){
        pacX = 9 * TILE_SIZE;
      }
      updatePacman(pacX, pacY);
    }

    else if (event.keyCode === 37){
      pacX -= TILE_SIZE;
      if (pacX <= 0){
        pacX = 0;
      }
      updatePacman(pacX, pacY);
    } 

    else if (event.keyCode === 38){
      pacY -= TILE_SIZE;  
      if (pacY <= 0){
        pacY = 0;
      }
      updatePacman(pacX, pacY);
    }   
    else if (event.keyCode === 40){
      pacY += TILE_SIZE; 
      if (pacY >= 9 * TILE_SIZE){
        pacY = 9 * TILE_SIZE;
      } 
      updatePacman(pacX, pacY);
    }     
    
  };

  document.body.addEventListener('keydown', handleKeyDown);
</script>

</html>